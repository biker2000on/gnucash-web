---
phase: 03-enhanced-account-hierarchy
plan: 03
type: execute
wave: 3
depends_on: [03-02-PLAN.md]
files_modified: [src/components/SummaryCards.tsx, src/app/api/accounts/summary/route.ts, src/app/(main)/accounts/page.tsx]
autonomous: true

must_haves:
  truths:
    - "Summary cards show totals for each account type"
    - "Cards update when date range changes"
    - "Period and total balances displayed"
  artifacts:
    - path: "src/components/SummaryCards.tsx"
      provides: "Account type aggregation cards"
    - path: "src/app/api/accounts/summary/route.ts"
      provides: "Aggregation endpoint"
  key_links:
    - from: "src/app/(main)/accounts/page.tsx"
      to: "src/components/SummaryCards.tsx"
      via: "component import"
---

<objective>
Create summary cards showing account type aggregations.

Purpose: Provide quick financial overview by account type (Assets, Liabilities, etc.).
Output: Summary cards component with API backing.
</objective>

<context>
@.planning/PROJECT.md
@.planning/phases/03-enhanced-account-hierarchy/03-RESEARCH.md
@src/app/(main)/accounts/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Create Summary API Endpoint</name>
  <files>src/app/api/accounts/summary/route.ts</files>
  <action>
    Create GET endpoint that:
    1. Accepts startDate and endDate query params
    2. Aggregates balances by account_type:
       - ASSET, LIABILITY, INCOME, EXPENSE, EQUITY
    3. Returns for each type:
       - account_count: number of accounts
       - total_balance: sum of all splits (all time)
       - period_balance: sum of splits in date range
    4. Calculate net worth (Assets - Liabilities)
    5. Calculate net income (Income - Expenses)
  </action>
  <verify>API returns correct aggregations matching manual calculation</verify>
  <done>Summary API provides account type aggregations.</done>
</task>

<task type="auto">
  <name>Create SummaryCards Component</name>
  <files>src/components/SummaryCards.tsx</files>
  <action>
    Create a responsive card grid showing:
    1. Assets card (green): total balance, period change
    2. Liabilities card (red): total balance, period change
    3. Net Worth card (blue): Assets - Liabilities
    4. Income card (green): period total
    5. Expenses card (red): period total
    6. Net Income card (blue): Income - Expenses

    Each card shows:
    - Icon and label
    - Large balance number
    - Period change with +/- indicator
    - Trend arrow (up/down)

    Style with Tailwind, support dark mode.
  </action>
  <verify>Cards render with sample data, responsive on mobile</verify>
  <done>SummaryCards component displays financial overview.</done>
</task>

<task type="auto">
  <name>Integrate into Accounts Page</name>
  <files>src/app/(main)/accounts/page.tsx</files>
  <action>
    1. Add SummaryCards above AccountHierarchy
    2. Fetch summary data with same date range as hierarchy
    3. Add date range picker if not present (reuse from journal)
    4. Cards and hierarchy share date context
  </action>
  <verify>Accounts page shows summary cards above tree</verify>
  <done>Accounts page has integrated summary view.</done>
</task>

</tasks>

<verification>
- Summary cards show correct totals
- Net Worth = Assets - Liabilities
- Period balance reflects date range filter
</verification>

<success_criteria>
Users see financial summary at a glance above account tree.
</success_criteria>

<output>
After completion, create `.planning/phases/03-enhanced-account-hierarchy/03-03-SUMMARY.md`
</output>
